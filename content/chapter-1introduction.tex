% !TEX TS-program = pdflatex
% !TEX root = ../thesis.tex
%
\chapter{Introduction}
\label{sec:intro}

%\cleanchapterquote{"Mens cujusque is est Quisque" â€“ "Mind Makes the Man"}{Samuel Pepys}{}


Nowadays, cameras are becoming more and more widely used in many aspects of human lifes such as taking pictures, medical analysis, security monitoring and control, etc. The camera imaging pipelines are of particular importance since it is the key step of transforming the real scenes into the images or videos. However, during the imaging process, the noise is unavoidablely generated due to many reasons.

\section{The Camera Imaging Pipeline}
\label{sec:intro:general}

The cameras capture the images and store as raw image formats. During the camera imaging pipeline, the photons are transformed into electronics by the photodiode in the camera sensor. The original sensor arrat (also called color filter array, or CFA) contains red, green, and blue channels, and these incomplete channels are transformed into the final RGB files via the raw converter. The camera imaging pipeline includes multiple stages such as reading raw image, black light subtraction, lens correction, demosaicing, noise reduction, white balancing, gamma curve, final color space conversion, etc \cite{browneccv2016}. Basically, a camera imaging pipeline includes demosaicing, white balancing and color space transform, gamut mapping, tone mapping, and JPEG compression \cite{crosschannel}. However, different cameras have varying structures and camera parameters, and hence resulting different imaging effects. Recently, there also exists learning based imaging pipelines which directly learn the  natural image priors from the RGB and raw images pairs.


\section{The Image Noise}
\label{sec:intro:current}

In image denoising community, the most commonly studied noise is the additive white Gaussian noise, which is used to model the independent noise in the raw images. The AWGN noise is described as a Gaussian distribution $\mathcal{N}(0,\sigma^{2})$, which means that the noise is Gaussian distributed with $0$ mean and $\sigma$ standard deviation. Most of methods are focus on this type of noise since it is a good testing bed for many other image restoration problems such as super-resolution, deblurring, inpainting, etc.

However, the realistic noise in real-world natural images captured by cameras are much more complex than the synthetic AWGN noise being widely studied. The major reason is that, during the imaging pipeline, the noise will be generated. The key reason of noise generation is unstable measurement from the discrete nature of light and the thermal agitation. The major sources of noise generated during the imaging pipeline are the random noise , the spatial non-uniformity, and quantization noise. The random noise includes photon shot noise, dark current, and readout noise. The spatial non-uniformity noise includes the fixed pattern noise (PRNU, DCNU), CCD/CMOS specific noise. 


A simplified model including various noise sources (for each pixel) can be approximately defined as follows:
\begin{equation}
\bm{P} = f((g_{cv}(\bm{C}+\bm{D})+\bm{N}_{reset})g_{out}+\bm{N}_{out})+\bm{Q}.
\end{equation}
Now the above equation is explained in details. 
$\bm{P}$ is the raw pixel value, 
$\bm{C}$ is the number of absorbed electrons (charges) transformed from the photons via the photon-diodes in the camera sensor,
$\bm{D}$ is the number of absorbed electrons generated by dark current,
$g_{cv}$ is the equivalent capacitance (EC) of the photo-diode,
$\bm{N}_{reset}$ is the thermal noise generated by the readout circuitry (or reset noise related to reset voltage),
$g_{out}$ is the gain factor during voltage to pixel value conversion (readout),
$\bm{N}_{out}$ is the readout noise,
$f$ is the camera response function, usually a linear function before attaining a saturation threshold,
$\bm{Q}$ is the quantization error happened during rounding to interger values. The quantization noise is normally negligible compared to the readout noise.

Though can be approximated as Gaussian or Poisson distribution, these noise sources will be largely changed to be more complex during the in-camera imaging pipeline, which has been analyzed in \cite{crosschannel}. Hence, the real-world noise is much more complex than the traditional additive white Gaussian noise, and should be paid more attention.

In order to obtain good images while still maintaining the structures and details of the captured scene, image denoising is a good choice. In this thesis, I will present my work on image denoising, including synthetic noisy images and real noisy images. Note that the realistic noise in real color noisy images are much more complex than the usually synthetic additive white Gaussian noise (AWGN). This is because that during the camera imaging pipeline, the noise generated will be modified to be more complex than the noise in the raw sensor data. Hence, in this thesis, we pay more attention to the realistic noise generated during the camera imaging pipeline. 


\section{The Proposed Methods}
\label{sec:intro:new}

This thesis is made up of several work I have done during my study, in which I focus on designing new and better image denoising algorithms. 

Firstly, we propose a method for denoising synthetic AWGN noise, from which we can study the performance of the nonlocal self-similarity priors of natural images. In fact, we propose to learn the external NSS priors and apply the learned model on denoising AWGN noise. The proposed method achieves state-of-the-art performance on AWGN denoising on both effectiveness and efficiency. 

Basing on the success on the synthetic noise removal, we propose to exploit the power of the NSS priors in natural images to deal with the complex realistic noise in real-world noisy images. Specifically, we propose three methods exploiting the NSS priors of natural images for real noisy image denoising, which can be introduced as follows.

The first method is to utilize the external natural images to learn a NSS prior, which is then applied into the denoising task of input synthetic noisy image degraded by AWGN noise. The second method is to make use of power of external natural images, and then use the external NSS priors to guide the learning of the internal NSS priors of the input real noisy images. The third method is to fully utilize the internal NSS prior and make use of low rank models to exploit the NSS property of the input real noisy images. The fourth method is to use the sparse coding based method with additional weighting scheme to regard the local noise in real noisy images as a Gaussian and the prior is used to deal with the real noisy image. Finally, we construct a big real noisy images captured by widely used commercial cameras, on which we evaluate the existing image denoising methods as well as our proposed methods in this thesis. 




The structure of this thesis is organized as follows: in the chapter 2, we review the literatures in the image denoising area; in the chapter 3, we introduce the fully external method; in the chapter 4, we introduce the external prior guided internal method; in the chapter 5, we introduce the internal method based on low ran model; in the chapter 6, we introduce the internal method based on sparse coding model; in the chapter 7, we introduce the real noisy image dataset we construct, and finaly evaluate the proposed methods with the compared competing methods, both for synthetic AWGN or Poisson noise and real noise, including the commercial software designed especially for real noise. 


\section{Thesis Structure}
\label{sec:intro:structure}


\textbf{Chapter \ref{sec:review}: Literature Review} \\[0.2em]

In this chapter, we review the related work and give a detailed introduction of the literature. We will first review the most representative work on additive white Gaussian noise removal. I review the detailed work on camera imaging pipeline and realistic noise generated in the camera sensors. I will also review the work on real noisy image denoising.



\textbf{Chapter \ref{sec:external}: External Nonlocal Self-Similarity Prior Learning for Synthetic Gaussian Noise Removal} \\[0.2em]

In this chapter, I will introduce our work on external nonlocal self-similarity (NSS) prior learning for synthetic Gaussian noise removal. As far as we know, this work is the first to learn the NSS priors of natural clean images, while previous work only utilize the NSS priors of input noisy image for online denoising. The advantages of this offline learning is that it can preserve the details of natural images while being much faster then most online denoising methods.


\textbf{Chapter \ref{sec:guided}: External Prior Guided Internal Prior Learning for Real Noisy Image Denoising} \\[0.2em]

In this chapter, I will introduce our work on external prior guided internal prior learning method for real noisy image denoising. This work can maintain the advantages of both sides: from the external perspective, the method can preserve the structures of natural images better than the internal methods, while from the perspective of internal method, the proposed method can recover the details of the input noisy image better than the external methods.



\textbf{Chapter \ref{sec:internallr}: Multi-channel Weighted Nuclear Norm Minimization for Real Color Image Denoising} \\[0.2em]

In this chapter, we introduce a multi-channel weighted nuclear norm minimization (MC-WNNM) method. This method regards different channels in RGB images differently to adaptively process the real color noisy images. Besides, this work also propose a new strategy for color image denoising. Experiments demonstrate that the proposed method can achieve better performance on real color image denoising than existing state-of-the-art methods, including some commercial software.



\textbf{Chapter \ref{sec:internalsc}: A Triple Weighted Sparse Coding Scheme for Realistic Noisy Image Denoising} \\[0.2em]

In this chapter, I introduce a novel sparse coding based method for real color image denoising. In this method, I regard the noise in each of the local region in the real noisy image as a Gaussian, and propose a triplely weighted scheme to deal with the complex realistic noise in real color noisy images. Experiments show that the proposed method performs better and faster than the nuclear norm based method mentioned in previous chapter.


\textbf{Chapter \ref{sec:dataset}: A Benchmark on Real Color Noisy Image, with Comprehensive Evaluation of State-of-the-art} \\[0.2em]

To fully boost the research of real color noisy image denoising, we construct a large benchmark on real color noisy images. This dataset is collected from several representative cameras with comprehensive settings on contents, lighting, ISO, shutter, and aperture, etc. Based on this newly established dataset, we fully evaluated existing denoising methods, including the methods designed for synthetic Gaussian noise and the methods designed especially for real color noise. We believe that this new dataset will largely boost the research of the image denoising especially the realistic image denoising problems.
















