%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% University of Western Ontario Thesis Template
% By: Justin Quinn Veenstra, 2010
% With thanks to Mr. (soon to be Dr.) Will Robertson.


\documentclass[12pt,oneside]{report}
\usepackage[footnotesize]{caption}
\usepackage{multirow}
%% Decomment next line to use PostScript fonts
%%\UsePackage{times}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                    %%
%%                    ***   we M P O R T A N T   ***                   %%
%%                                                                    %%
%% Fill in the following fields with the required information:        %%
%%  - \department{...}  name of the graduate department               %%
%%  - \degree{...}      name of the degree obtained                   %%
%%  - \author{...}      name of the author                            %%
%%  - \title{...}       title of the thesis                           %%
%%  - \gyear{...}       year of graduation                            %%
%%  - \super{...}    supervisor
%%  - \firstname, \middlename, \lastname... there is additional documentation by the actual fields, so we'll leave it at that
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{appendix}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage[byname]{smartref}
%\usepackage{hyperref} %comment out for hardcopy
\usepackage{txfonts}
\usepackage{tocloft}
\usepackage{amsopn}
\usepackage{bibref}
\usepackage{multirow}
\usepackage{lscape}
\usepackage{color}
\usepackage{cite}
\usepackage{bm}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{url}
\usepackage{bm}
\usepackage{float}
\makeatletter
\let\c@lofdepth\relax
\let\c@lotdepth\relax
\makeatother
\usepackage{subfigure}
\newcommand{\ignore}[1]{}

\newtheorem{Lemma}{Lemma}
%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{lemma}[theorem]{Lemma}

%---------------------------------------------
\usepackage{graphicx}
\usepackage{amsmath,amssymb} % define this before the line numbering.
\usepackage{color}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
%\newcommand{\ignore}[1]{}
%---------------------------------------------------
\usepackage[numbers,sort&compress]{natbib}
\setlength{\bibsep}{0.1ex}  % vertical spacing between references


%-------added by Jun Xu
\usepackage{changepage}
\DeclareMathOperator*{\argmin}{arg\,min}
\usepackage{arydshln}
\usepackage{titlesec}


\usepackage[pagebackref=true,breaklinks=true,letterpaper=true,colorlinks,bookmarks=false]{hyperref}

\makeatletter
\numberwithin{figure}{chapter}
\newenvironment{acknowledgements}%
{\clearemptydoublepage
 \begin{center}\includegraphics[]{C:/Users/csjunxu/Desktop/CVPR2018 Denoising/PolyU/Canon5D2_5_160_6400_bicycle_10_real.JPG}

  \section*{Acknowledgements}
 \end{center}
 \begingroup
}{\newpage\endgroup}

\newenvironment{dedication}%
{\clearemptydoublepage
 \begin{center}
  \section*{Dedication}
 \end{center}
 \begingroup
}{\newpage\endgroup}

\newenvironment{preliminary}%
{\pagestyle{plain}\pagenumbering{roman}}%
{\pagenumbering{arabic}}

\addtoreflist{chapter}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\newenvironment{proof}[1][Proof]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{definition}[1][Definition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{example}[1][Example]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{remark}[1][Remark]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}

% Default values for title page.


%% To produce output with the desired line spacing, the argument of
%% \spacing should be multiplied by 5/6 = 0.8333, so that 1 1/2 spaced
%% corresponds to \spacing{1.5} and double spaced is \spacing{1.66}.
\def\normalspacing{1.25} % default line spacing


%% Define the "thesis" page style.
\if@twoside % If two-sided printing.
\def\ps@thesis{\let\@mkboth\markboth
   \def\@oddfoot{}
   \let\@evenfoot\@oddfoot
   \def\@oddhead{
      {\sc\rightmark} \hfil \rm\thepage
      }
   \def\@evenhead{
      %\rm\thepage \hfil {\sc\leftmark}
%      }
    {\rm\thepage \hfil \sc\rightmark}
      }
   \def\chaptermark##1{\markboth{\ifnum \c@secnumdepth >\m@ne
      Chapter\ \thechapter. \ \fi ##1}{}}
   \def\sectionmark##1{\markright{\ifnum \c@secnumdepth >\z@
      \thesection. \ \fi ##1}}}
\else % If one-sided printing.
\def\ps@thesis{\let\@mkboth\markboth
   \def\@oddfoot{}
   \def\@oddhead{
      {\sc\rightmark} \hfil \rm\thepage
      }
   \def\chaptermark##1{\markright{\ifnum \c@secnumdepth >\m@ne
      Chapter\ \thechapter. \ \fi ##1}}}
\fi

%%% changed by Jun Xu
%\pagestyle{thesis} % keep the head of each page
\thispagestyle{plain} % remove the head of each page

% Set up page layout.
\renewcommand{\baselinestretch}{1.6} % double line-space 1.66
\setlength{\textheight}{8.5in} % Height of the main body of the text
\setlength{\topmargin}{-.5in} % .5" margin on top of page -.5
\setlength{\headsep}{.5in}  % space between header and top of body
\addtolength{\headsep}{-\headheight} % See The LaTeX Companion, p 85
\setlength{\footskip}{.5in}  % space between footer and bottom of body
\setlength{\textwidth}{6.2in} % width of the body of the text
\setlength{\oddsidemargin}{0.25in} % 1.25" margin on the left for odd pages0.8in
\setlength{\evensidemargin}{0.15in} % 1.25"  margin on the right for even pages0.15in

% Marginal notes
\setlength{\marginparwidth}{.75in} % width of marginal notes
\setlength{\marginparsep}{.125in} % space between marginal notes and text

% Make each page fill up the entire page. comment this out if you
% prefer.
\flushbottom

\setcounter{tocdepth}{3} % Number the subsubsections
\def\normalspacing{1.25} % default line spacing

\newcommand\isco[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else \\\underline{Co-Supervisor:}\vspace{0.35in}\\\dots\dots\dots\dots\dots\dots\dots\\{#1}\\
  \fi
}

\newcommand\isjoint[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else \\\underline{Joint Supervisor:}\vspace{0.35in}\\\dots\dots\dots\dots\dots\dots\dots\\{#1}\\
  \fi
}

\newcommand\isalt[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else \\\underline{Alternate Supervisor:}\vspace{0.35in}\\\dots\dots\dots\dots\dots\dots\dots\\{#1}\\
  \fi
}

\newcommand\isdefinedsig[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else\rule[-4.5pt]{5.5cm}{0.5pt}\signname\\ \\{#1}\\
  \fi
}

\newcommand\isdefinedsigname[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else\rule[-5pt]{0.05cm}{0.5pt}\underline{}\rule[-5pt]{4cm}{0.5pt}\stuname\\ \\{#1}\\%\dots\dots\dots\dots\dots\dots\dots
  \fi
}
\newcommand\isdefinedspinetitle[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else (Spine title: #1)\\
  \fi
}
\newcommand\coauthor[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else \newpage \Large Co-Authorship Statement\normalsize\\\indent\\#1\\
  \fi
}

\newcommand\acknowlege[1]{%
  \edef\@tempa{#1}%
  \def\@tempb{}%
  \ifx\@tempa\@tempb
	\else \newpage \Large Acknowlegements\normalsize\\\indent\\#1\newpage
  \fi
}

%\renewcommand{\appendixtocname}{\Huge \textbf{List of Appendices} \normalsize}
\newcommand{\blank}{\hspace{-2mm}}
\newcommand{\super}{Dr. David Zhang} %supervisor
\newcommand{\signname}{(Signed)}
\newcommand{\stuname}{(Name of student)}
\newcommand{\superj}{} %joint supervisor, if there is one, leave blank if not (lbin)... only one of the three.
\newcommand{\superc}{Dr. Lei Zhang} %co-supervisor, if there is one, leave blank if not (lbin)
\newcommand{\supera}{} %alternate supervisor, if there is one, leave blank if not (lbin)
\newcommand{\sco}{ }  %member of supervisory committee
\newcommand{\sct}{ }  %other member of supervisory committee (lbin)
\newcommand{\examo}{ }  %examining committee (up to four, if less leave blank)
\newcommand{\examt}{ }
\newcommand{\examth}{ }
\newcommand{\examf}{}
\newcommand{\department}{Computing}
\newcommand{\degree}{Doctor of Philosophy}
\newcommand{\firstname}{Jun}
\newcommand{\middlename}{}
\newcommand{\lastname}{Xu}
%\renewcommand{\author}[1]{\ifx\empty#1\else\gdef\@author{#1}\fi}
\newcommand{\authorname}{{\firstname} {\middlename} {\lastname}}
\newcommand{\titl}{Real-time and Robust Visual Tracking}
%\newcommand{\spinetitle}{Plib}%only if the above is more than 60 characters
\newcommand{\thesisformat}{Monograph} %or Integrated Article
\newcommand{\gyear}{\number\year}
\newcommand{\makecoauthor}{
%Type information about coauthorship here/

}
\newcommand{\makeacknowlege} {
%Type in acknowlegements here
}
\newcommand{\listappendixname}{List of Appendices}
\newlistof{myappendices}{app}{\listappendixname}
\newcommand{\myappendices}[1]{%
\addcontentsline{app}{myappendices}{#1}\par}

\renewcommand{\maketitle}
{\begin{titlepage}
   \setcounter{page}{1}
   %% Set the line spacing to 1 for the title page.
   %\begin{spacing}{1}
   \begin{large}
   \begin{center}
      \mbox{}
      \vfill
    %  {\MakeUppercase{\titl}}\\
     % \isdefinedspinetitle{\spinetitle}
%      (Thesis format: \thesisformat)\\
	{\LARGE The Hong Kong Polytechnic University} \\
    {\Large Department of Computing}\\
      \vfill
      {\LARGE Nonlocal Self-Similarity Based Prior Modelling for Image Denoising} \\
     % by \\
      \vfill
       {\firstname}  {\lastname}\\

     % \vfill
%      Graduate Program in {\department}\\
      \vfill
		A thesis submitted in partial fulfillment\\
		of the requirements for the degree of\\
		\degree\\
		\vfill
	%	The School of Graduate and Postdoctoral Studies\\
%		The Hong Kong Polytechnic University\\
%		Hong Kong\\
		\vfill
    %  {\copyright} {\authorname} {\gyear}  \\
     Dec. 2017\\
      \vspace*{.2in}

   %   Temporary Binding for Examination Purposes\\

   \end{center}
   \end{large}
%   \end{spacing}
   \end{titlepage}

}%\maketitle
\cleardoublepage

\newcommand{\makecert}{
   \setcounter{page}{2}
\vfill
\begin{center}
\large
\textbf{CERTIFICATE OF ORIGINALITY}\\
\vfill
\end{center}

\vfill
We hereby declare that this thesis is my own work and that, to the best of my knowledge and belief, it reproduces no material previously published or written, nor material that has been accepted for the award of any other degree or diploma, except where due acknowledgement has been made in the text. \\
\vfill
\vfill
\vfill
\hspace{2.5in}\isdefinedsig{ }
\vfill
\hspace{2.5in}\isdefinedsigname{ }\\
\vfill
\vfill
\vfill
\vfill
}

\makeatother
\begin{document}

%% ***   NOTE   ***
%% You should put all of your '\newcommand', '\newenvironment', and
%% '\newtheorem's (in other words, all the global definitions that you
%% will need throughout your thesis) in a separate file and use
%% "\input{filename}" to input it here.


%% This sets the page style and numbering for preliminary sections.
\begin{preliminary}

%% This generates the title page from the information given above.
\maketitle
\addcontentsline{toc}{chapter}{Certificate of Examination}
\makecert
\newpage


\addcontentsline{toc}{chapter}{Abstract}
\Large\begin{center}\textbf{Abstract}\end{center}\normalsize

%%  ***  Put your Abstract here.   ***
%% (150 words for M.Sc. and 350 words for Ph.D.)

The nonlocal self-similarity (NSS) prior of natural images has been successfully used in many image restoration methods. In this thesis, we investigate the design of new and more effective NSS models for image denoising tasks, especially real-world image denoising. A new dataset to benchmark the study of real-world image denoising method is also established.

To exploit the NSS prior from the external clean natural images, we propose a patch group (PG) based NSS prior learning scheme to learn explicit NSS models from natural images for high performance denoising. PGs are extracted from training images by putting nonlocal similar patches into groups, and a PG based Gaussian Mixture Model (PG-GMM) learning algorithm is developed to learn the NSS prior. We demonstrate that, owe to the learned PG-GMM, a simple weighted sparse coding model, which has a closed-form solution, can be used to perform image denoising effectively, resulting in high PSNR measure, fast speed, and particularly visually pleasing denoising outputs.

The noise in real-world images captured by digital cameras is hard to be characterized by the additive white Gaussian noise (AWGN) model. Therefore, many denoising methods developed under the AWGN assumption may not work well on real-world images. To exploit the information in both external data and the given noisy image, we develop an external prior guided internal prior learning method for real-world noisy image denoising. We first learn external priors from an independent set of clean natural images. With the aid of learned external priors, we then learn internal priors from the given noisy image to refine the prior model. The external and internal priors are formulated as a set of orthogonal dictionaries to efficiently reconstruct the desired image. Extensive experiments are performed on several real-world noisy image datasets. The proposed method demonstrates highly competitive denoising performance, outperforming state-of-the-art denoising methods including those designed for real-world noisy images.

We then investigate how to utilize solely the internal NSS of noisy images for real-world image denoising task. To this end, we propose a multi-channel (MC) optimization model for real color image denoising under the weighted nuclear norm minimization (WNNM) framework. We concatenate the RGB patches to make use of the channel redundancy, and introduce a weight matrix to balance the data fidelity of the three channels in consideration of their different noise statistics. The proposed MC-WNNM model has no analytical solution. We reformulate it into a linear equality-constrained problem and solve it via alternating direction method of multipliers. Each alternative updating step has a closed-form solution and the convergence can be guaranteed. Experiments on both synthetic and real noisy image datasets demonstrate the superiority of the proposed MC-WNNM model over state-of-the-art image denoising methods.

We also develop a trilateral weighted sparse coding (TWSC) scheme for robust realistic image denoising. Specifically, we introduce three weight matrices into the data and regularization terms of the sparse coding framework to characterize the statistics of realistic noise and image priors. TWSC can be reformulated as a linear equality-constrained problem and can be solved by the alternating direction method of multipliers. The existence and uniqueness of the solution and convergence of the proposed algorithm are analyzed. Extensive experiments demonstrate that the proposed TWSC scheme outperforms state-of-the-art denoising methods on removing realistic noise.

Finally, to benchmark the real-world image denoising problem, and to complement the previous datasets, we construct a new dataset which contains more comprehensive scene contents with more camera brands and camera settings. Extensive comparison experiments are performed on existing and our new benchmark datasets. The results show that our new dataset is more challenging than previous ones, and real-world image denoising is still a challenging task which needs broader and deeper study.

In summary, in this thesis we investigate in-depth the learning of NSS priors for image denoising, develop several new and effective denoising models, and present a new dataset of real-world noisy images. The research outputs of this these not only enrich the understanding of NSS based statistical image modeling, but also demonstrate state-of-the-art performance in image denoising, especially real-world image denoising.


\textbf{Keywords:} Real-world image denoising, Nonlocal self-similarity, Sparse models, Low-rank models.

\newpage
\addcontentsline{toc}{chapter}{Publication}
\Large\begin{center}\textbf{List of Publications}\end{center}\normalsize

\textbf{Journal Papers} (Published and under revision)
\begin{enumerate}
 \item \textbf{Jun Xu}, Lei Zhang, David Zhang,``External Prior Guided Internal Prior Learning for Real Noisy Image Denoising''. Major Revision in IEEE Transactions on Image Processing, 2017.
  \item Dongwei Ren, Wangmeng Zuo, David Zhang, \textbf{Jun Xu}, Lei Zhang, ``Partial Deconvolution with Inaccurate Blur Kernel''. IEEE Transactions on Image Processing, 27(1), 511--524, 2018. 

\end{enumerate}

\textbf{Conference Papers}
\begin{enumerate}
  \item \textbf{Jun Xu}, Lei Zhang, Wangmeng Zuo, David Zhang and Xiangchu Feng, ``Patch Group Based Nonlocal Self-Similarity Prior Learning for Image Denoising ''. International Conference on Computer Vision (ICCV), 244--252, Santiago, Chile, 2015.
  \item \textbf{Jun Xu}, Lei Zhang, David Zhang, Xiangchu Feng, ``Multi-channel Weighted Nuclear Norm Minimization for Real Color Image Denoising''. International Conference on Computer Vision (ICCV), 1096--1104, Venice, Italy, 2017.
 \item \textbf{Jun Xu}, Lei Zhang, David Zhang,``A Trilateral Weighted Sparse Coding Scheme for Realistic Image Denoising''. Submitted to CVPR 2018.
 \item \textbf{Jun Xu}, Deyu Meng, Lei Zhang, David Zhang,``Scaled Simplex Representation for Efficient Subspace Clustering''. Submitted to CVPR 2018.
 \item \textbf{Jun Xu}, Lei Zhang, David Zhang,``Sparse, Collaborative, or Non-negative Representation: Which Helps Pattern Classification?''. Submitted to CVPR 2018.
 \item Zhetong Liang, \textbf{Jun Xu}, David Zhang, Zisheng Cao, Lei Zhang, ``A Hybrid L1-L0 Layer Decomposition Model for Tone Mapping''. Submitted to CVPR 2018.
 \item Wangpeng An, Haoqian  Wang, Qingyun  Sun, \textbf{Jun Xu}, Lei Zhang, Qionghai  Dai, ``A PID Controller Approach for Stochastic Optimization of Deep Networks''. Submitted to CVPR 2018.

\end{enumerate}

\newpage
\include{acknowledgement}   % you can try this way, writing in another file

\tableofcontents\newpage
\newpage
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures
\newpage
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables
%\addcontentsline{toc}{chapter}{List of Appendices }
%\listofmyappendices
%\newpage
\cleardoublepage  % �ӿհ�ҳ��ʹ��һ�¿�ʼΪ����ҳ


%\addcontentsline{toc}{chapter}{List of Abbreviations, Symbols, and Nomenclature}
%\large List of Abbreviations, Symbols, and Nomenclature \normalsize
%\newpage
\end{preliminary}


%% End of the preliminary sections: reset page style and numbering.

%% ����ͼ����ʽ:��#1��������ΪС�ź��壬#2����������С�����壬�м�һ���ո�
%% һ�б������У����б��⿿��
\makeatletter
%\def\fnum@table{\small Table \thetable}
%\def\fnum@figure{\small Figure \thefigure}
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{{\bfseries\small #1}\quad \small#2}%
  \ifdim \wd\@tempboxa >\hsize
    {\bfseries\small #1}\quad \small #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                    %%
%%                    ***   we M P O R T A N T   ***                   %%
%%                                                                    %%
%% Put your Chapters here; the easiest way to do this is to keep each %%
%% chapter in a separate file and \include all the files right here.  %%
%% Note that each chapter file should start with the line             %%
%% "\chapter{ChapterName}".  Note that using "\include" instead of    %%
%% "\input" makes each chapter start on a new page.                   %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\include{chapter1}
\include{chapter2}
\include{chapter3}
\include{chapter4}
\include{chapter5}
\include{chapter6}
\include{chapter7}
\include{chapter8}

%% This adds a line for the Bibliography in the Table of Contents.
\addcontentsline{toc}{chapter}{Bibliography}
%% ***   Set the bibliography style.   ***
%\setlength{\itemsep}{-1cm}
%\bibliographystyle{plain} % (change according to your preference)

%%%%%%%%%%%%%%%���������������òο����׵ĸ�ʽ%%%%%%%

%%% ***   Set the bibliography file.   ***
%\newpage
%\addcontentsline{toc}{chapter}{References}
\bibliographystyle{plain}
%\renewcommand{\bibname}{References}
%\bibliographystyle{unsrt}
\bibliography{bib-refs}
%\input{westernthesis}
%\end{singlespace}

%% ***   NOTE   ***
%% If you don't use bibliography files, comment out the previous line
%% and use \begin{thebibliography}...\end{thebibliography}.  (In that
%% case, you should probably put the bibliography in a separate file
%% and \include or \input it here).

%Appendices.
%\begin{appendices}
%\include{appendixa}
%\end{appendices}

%CV only relevant stuff... not full CV.
%\addcontentsline{toc}{chapter}{Curriculum Vitae}
%\chapter*{Curriculum Vitae}
%\begin{table}[ht]
%\begin{tabular}{ll}
%\textbf{Name:} & \firstname{} \lastname\\\\
%\textbf{Post-Secondary} & La La School\\
%\textbf{Education and}& La La Land\\
%\textbf{Degrees:}& 1996 - 2000 M.A.\\\\
%& University of Western Ontario\\
%& London, ON\\
%& 2008 - 2012 Ph.D.\\\\
%\textbf{Honours and}& NSERC PGS M\\
%\textbf{Awards:}& 2006-2007\\\\
%\textbf{Related Work}& Teaching Assistant\\
%\textbf{Experience:}& The University of Western Ontario\\
%& 2008 - 2012\\
%\end{tabular}
%\end{table}
%\subsubsection*{Publications:}
%La La
\end{document}

